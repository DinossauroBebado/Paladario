//-----Projeto:32:00                                                                 ---------
//-----Titulo:Paladario                                                              ---------
//-----Autor:Dinossauro Bebado                                                       ---------
//-----Objetivo :Ter controle de sensores, luzes e equipamentos do paladario          --------
//-----atraves da internet                                                           ---------
//--------------------------------------------------------------------------------------------
//--------------------------------------------------------------------------------------------
//--------------------------------------------------------------------------------------------
//--------------------------------------------------------------------------------------------
//--------------------------------------------------------------------------------------------
//--------------------------------------------------------------------------------------------
//--------------------------------------------------------------------------------------------
//--------------------------------------------------------------------------------------------
//--------------------------------------------------------------------------------------------
//--------------------------------------------------------------------------------------------
//--------------------------------------------------------------------------------------------
//--------------------------------------------------------------------------------------------
//--------------------------------------------------------------------------------------------
//--------------------------------------------------------------------------------------------
//--------------------------------------------------------------------------------------------
//--------------------------------------------------------------------------------------------
//--------------------------------------------------------------------------------------------
//--------------------------------------------------------------------------------------------
//--------------------------------------------------------------------------------------------
//--------------------------------------------------------------------------------------------
#include <NTPClient.h>
#include <ESP8266WiFi.h>
#include <WiFiUdp.h>
//-------------------Wi-fi Config--------------------------#
const char *ssid     = "Torta";
const char *password = "3141592653589";
//-------------------NTP Config----------------------------#
const long utcOffsetInSeconds = -10800;
char daysOfTheWeek[7][12] = {"Domingo", "Segunda", "Terça", "Quarta", "Quinta", "Sexta", "Sabado"};
//-------------------Wi-fi Config--------------------------#
int hora_ligar = 19; 
int hora_desligar = 20;
//-------------------Definição de pinos--------------------#
const int bomba = D8 ; 
const int luz = D7 ; 
//-------------------Declaração de variaveis---------------#
int hora;
int minutos;
// Define o cliente NTP para ter o tempo
WiFiUDP ntpUDP;
NTPClient timeClient(ntpUDP, "pool.ntp.org", utcOffsetInSeconds);

void setup(){
  Serial.begin(115200);

  WiFi.begin(ssid, password);

  while ( WiFi.status() != WL_CONNECTED ) {
    delay ( 500 );
    Serial.print ( "." );
  }

  timeClient.begin();
  pinMode(luz,OUTPUT);
  pinMode(bomba,OUTPUT);
  
}

void loop() {
  timeClient.update();
  minutos = timeClient.getMinutes();
  hora = timeClient.getHours();
  Serial.println(hora);
  while(hora>=hora_ligar && hora<=hora_desligar)
  {
  Serial.println("Paladario ligado");
  Serial.println(hora);
  digitalWrite(luz,HIGH);
  timeClient.update();
  delay(1000);
  }
  
  digitalWrite(luz,LOW);
  delay(1000);
}
